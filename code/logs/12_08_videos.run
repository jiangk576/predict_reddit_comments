root@ip-10-197-92-49 ~]$ spark/bin/spark-submit --master spark://ec2-54-193-213-140.us-west-1.compute.amazonaws.com:7077 reddit-prediction-assembly-1.0.jar -g videos -p tfidf -m linear --limit 500000
Loading from bigquery bucket: cs260-1128:15_09.videos
Loaded 602538 rows
602538 total comments
550192 total comments after filtering
500000 comments after limiting
Using tfidf feature pipeline
500000 total comments after preprocessing
[(10030,[97,1398,1751,2875,3020,3365,3543,4685,4702,4801,9070,9839,10000,10001,10003,10020,10027],[0.9521997414107132,4.09031470110673,2.101656431324037,3.3898440976220208,5.293530849814239,1.4465645464653516,1.2352866088431989,4.037928422315302,4.977976511854707,0.7615693589220556,1.643182855997058,1.447108500514648,49.0,4.083333333333333,12.0,1.0,2.0])]
[(10030,[97,182,3371,3495,3543,3555,3791,5028,5208,6044,7037,7481,9038,9156,10000,10001,10003,10020,10027,10028],[0.9521997414107132,2.720043813952588,1.5584996803637161,6.359635870470449,1.2352866088431989,2.1993628575567934,6.361950686318901,3.632198708939949,5.621283253142457,7.6334276512456425,3.522824789784017,1.7928460571789873,5.3091781098809125,7.569405792480711,49.0,3.5,14.0,1.0,-1.5,1.0])]
[(10030,[1074,2374,3308,3314,3644,3747,3964,4163,4566,6673,6852,7631,8120,8196,8287,9070,9839,10000,10001,10003,10020,10027,10028],[22.034139162539017,7.363463603525048,3.485646775737775,2.8547556802924188,3.543638905559402,3.251039511674597,2.130349542652111,5.512998839448117,4.49919186244886,2.6089763929095224,1.987893148293467,7.347813831857921,6.699118413868809,2.4269265752476747,6.612107036879179,1.643182855997058,2.894217001029296,101.0,5.05,20.0,1.0,-1.0,1.0])]
[(10030,[182,1685,1821,3357,3365,3430,3504,3543,3687,3707,4055,5123,5968,6460,6852,7191,7724,9070,9135,9345,9609,9734,9820,9950,10000,10001,10003,10020],[2.720043813952588,2.6389833325011125,7.501964511685179,2.017739032561399,2.893129092930703,5.233655853220315,2.7736152468839705,1.2352866088431989,7.425271890896925,1.018818380675879,5.48464894473753,2.3662087012893704,6.219622640243736,5.915988085930077,1.987893148293467,3.4348595831527904,4.970455504461424,1.643182855997058,5.92119449412065,5.008339935045572,4.333924419997735,2.1206822896944337,3.3863501788099497,4.751586204441628,133.0,5.32,25.0,1.0])]
[(10030,[2168,3117,3137,3371,9270,10000,10001,10003,10020],[8.131932790623592,2.5528192499969884,4.260165046915041,1.5584996803637161,3.776795056166042,20.0,4.0,5.0,1.0])]
[(10030,[1021,3325,4637,7481,8625,10000,10001,10003,10020,10028],[6.005159874237984,2.360216205828682,4.652683168657143,1.7928460571789873,6.036463913036718,19.0,3.8,5.0,1.0,1.0])]
[(10030,[105,414,2662,2979,3365,3747,3854,3964,4545,4627,4673,4801,5341,5686,6342,6852,7396,7767,7806,7921,8022,8196,8256,8823,8893,8952,10000,10001,10003,10020],[2.458817716761556,2.7895008967117234,3.637048305471919,4.543324782660012,1.4465645464653516,3.251039511674597,3.239846131302397,2.130349542652111,4.264281155203167,3.77035184711,5.970879913497593,0.7615693589220556,6.932115908017304,5.907860963251185,4.653102719743641,1.987893148293467,2.9184399546257422,5.043367118717175,4.810230269753916,4.010186626312544,4.910610980027132,2.4269265752476747,2.650783793309818,1.3376585895119963,7.166528007937498,2.2076769932090605,113.0,3.896551724137931,29.0,1.0])]
[(10030,[1122,1596,2829,2939,3299,3365,3544,3676,3945,4744,4801,5123,5530,6852,7337,7525,7882,7999,8059,8817,9839,10000,10001,10003,10020,10027],[2.8512530497412167,4.242614578889204,3.4015994616814953,4.661319346609092,6.9238866609100205,1.4465645464653516,6.6734759832554715,2.3469152268415887,8.752917524935308,7.573289292507109,0.7615693589220556,2.3662087012893704,3.0967929443159634,1.987893148293467,4.804599210682985,2.8489708121587505,4.969015619403437,6.421634267854518,5.5717041342969935,3.0634565240483713,2.894217001029296,99.0,4.5,22.0,1.0,1.0])]
[(10030,[1741,4643,10000,10001,10003,10020,10027],[5.751505210865613,7.780031125437518,12.0,6.0,2.0,1.0,3.0])]
[(10030,[0,25,97,672,808,1051,1228,1362,1407,1468,1577,1751,1850,1875,2290,2322,2340,2642,3116,3117,3357,3370,3371,3434,3543,3555,3563,3658,3676,3707,3929,4079,4618,4801,5123,5197,5240,5716,5803,6000,6079,6182,6432,6727,6748,6944,6948,6965,7172,7247,7302,7481,7571,7776,8414,8823,8902,8982,9026,9070,9074,9142,9267,9490,9829,9839,10000,10001,10002,10003,10020,10027,10028],[8.103583356382416,5.094562529032017,1.9043994828214263,3.5936440042250952,5.4779246158457635,5.62849149061877,10.607870210663345,5.635191683188589,3.478296432045122,4.488812384869896,1.6820643701531017,4.203312862648074,10.136611608531275,8.574018812561446,5.44126637586597,3.7716545525788705,4.376285160044816,5.07166199593203,3.1543549288507013,2.5528192499969884,2.017739032561399,1.3445864409203407,6.2339987214548644,3.525131282903417,2.4705732176863977,2.1993628575567934,3.601456829187664,3.420994008988335,2.3469152268415887,4.075273522703516,9.550498032727218,3.602997378954987,6.892811948996469,3.0462774356882223,7.098626103868112,3.5260825638068454,3.788465658366375,4.075485554579182,5.220617858882185,4.8166342325264635,10.335986209740925,2.612405714217087,5.071024444109351,2.3660841937094172,5.6141987094028885,3.7672322605246054,5.419809264133747,3.6105139950379237,8.229751706945187,4.873051631141693,7.171494830430005,3.5856921143579745,2.8693130987226136,7.7378703146132395,3.605791087579838,1.3376585895119963,5.053023010590693,3.8227328979473842,3.9440318015612323,3.286365711994116,3.9290694400354043,3.541013325387361,1.8845875369931058,3.1287172451582435,3.5781275091774023,5.788434002058592,675.0,6.617647058823529,3.0,102.0,1.0,1.6,5.0])]
Split into 349619 training and 150381 test comments
Learning using Vanilla Linear Regression, using reg param: 0.0
Training RMSE: 102.09677646435037
Testing RMSE: NaN
+--------------------+--------------------+------------+-------------------+------------------+
|                body|               words|score_double|         prediction|            sq_err|
+--------------------+--------------------+------------+-------------------+------------------+
|Same here. But I ...|[same, here., but...|         1.0|  7.133225172224044|37.616451013202656|
|Hello /u/linhkaka...|[hello, /u/linhka...|         1.0|   4.33196469564163| 11.10198873300222|
|Oh man. I remembe...|[oh, man., i, rem...|         1.0|  7.473018754620107| 41.89997179766363|
|the central quest...|[the, central, qu...|         1.0|   52.1259266133735| 2613.860372076053|
|You call it "disg...|[you, call, it, "...|         2.0|-17.691865593981426| 387.7695705714294|
|I know I am color...|[i, know, i, am, ...|         1.0|  4.795965488844487|14.409353992498367|
|I think we're run...|[i, think, we're,...|         2.0| 61.028689107995355|3484.3861378083693|
|Is this sarcasm? ...|[is, this, sarcas...|        66.0|  34.66249725032424| 982.0390785859356|
|It sounded like t...|[it, sounded, lik...|         1.0| 2.6785608733650417|2.8175666055920114|
|I get to experien...|[i, get, to, expe...|         1.0|  6.353029521829761| 28.65492506158096|
+--------------------+--------------------+------------+-------------------+------------------+
only showing top 10 rows

Displaying top 10 features
[14.304639530221136] Feature 4865
[12.357170192399375] Feature 9958
[9.557669220587334] Feature 8796
[9.330884703467751] Feature 5993
[8.741296027108703] Feature 3250
[8.615501190102572] Feature 9323
[8.51562848629277] Feature 4141
[7.9663202246348455] Feature 530
[7.695566706769257] Feature 5129
[7.63557626594447] Feature 2349
